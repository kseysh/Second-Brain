# 주소정보의 표현

### IPv4 기반의 주소표현을 위한 구조체
![[Pasted image 20240924152437.png|400]]
ipv4인지 IPv6인지 확인하는 주소체계, IP 번호와 port 정보가 들어간다.

IPv4는 4byte이고, 32bit이다. 이는 십진법으로 40억 정도인데, 이를 십진법으로 표현하기에는 너무 복잡하여, 1byte씩 끊어서 127.0.0.1 이렇게 표현하는 것이다.
따라서 in_addr_t를 unsigned int 32로 표현하는 것이다.

## 네트워크 바이트 순서와 인터넷 주소 변환
### CPU에 따라 달라지는 바이트 순서
#### 빅 엔디안
상위 바이트의 값을 작은 번지수에 저장
#### 리틀 엔디안
상위 바이트의 값을 큰 번지수에 저장
![[Pasted image 20240924154452.png|250]]
### 네트워크 바이트 순서
빅 엔디안을 기준으로 데이터 송수신 기준을 통일하였다.
## 바이트 순서 변환 함수
빅엔디안으로 통일하여 사용하기 위해 바이트 순서를 변환한다.
![[Pasted image 20240924154717.png|400]]
hton을 하면 내가 쓰는 바이트 순서가 네트워크 바이트 순서로 바뀌고,
ntoh를 하면 네트워크 바이트 순서가 내가 쓰는 바이트 순서로 바뀐다.
short는 보통 port 번호를 다룰 때, long은 32bit라 ip주소를 다룰 때 사용한다.
## IP 주소의 문자열 정보를 네트워크 바이트 순서의 정수로 변환
### `inet_addr`
"211.214.107.99"와 같이 점이 찍힌 10진수로 표현된 문자열을 전달하면, 해당 문자열 정보를 참조해서 IP주소정보를 빅 엔디안으로 변환된 32비트 정수형으로 반환.
### `inet_aton`
![[Pasted image 20240924155919.png|300]]
기능상으로 inet_addr함수와 동일하지만, input이 string에, output이 in_addr에 저장된다.
## 정수형 IP주소 정보를 문자열 정보로 변환
### `inet_ntoa`
inet_aton함수의 반대 기능 제공 네트워크 바이트 순서로 정렬된 정수형 IP 주소 정보를 우리가 눈으로 쉽게 인식할 수 있는 문자열의 형태로 변환
## 인터넷 주소의 초기화
### 일반적인 인터넷 주소의 초기화 과정
![[Pasted image 20240924160340.png|380]]
### 서버에서 주소정보를 설정하는 이유
설정된 IP와 port로 들어오는 데이터를 보내달라고 요청하기 위함
### 클라이언트에서 주소정보를 설정하는 이유
설정된 IP와 port로 연결을 하라고 요청하기 위함
## `INADDR_ANY`
현재 실행중인 컴퓨터의 IP를 소켓에 부여할 때 사용되는 것
127.0.0.1과 public ip 모두를 부여해준다.
서버 프로그램의 구현에 주로 사용됨.

## 예제 실행방식
### `./hserver 9|90`
서버의 실행방식, 서버의 리스닝 소켓 주소는 INADDR_ANY로 지정을 하니, 소켓의 PORT번호만 인자를 통해 전달하면 된다.
### `./hclient 127.0.0.1 9190`
클라이언트의 실행방식, 연결할 서버의 IP와 PORT번호를 인자로 전달한다.
127.0.0.1은 루프백 주소라 하며, 이는 클라이언트를 실행하는 컴퓨터의 IP주소를 의미한다.
루프백 주소를 전달한 이유는, 서버와 클라이언트를 한 대의 컴퓨터에서 실행시켰기 때문.