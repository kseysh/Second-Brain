사실 객체에서의 양방향 연관관계는 서로 다른 단방향 연관관계가 서로 두 개가 있는 것으로 테이블 연관관계와는 약간 다르다.
![[Pasted image 20231027221853.png]]

![[Pasted image 20231027222127.png]]

![[Pasted image 20231027222153.png]]
어떤 것으로 외래키를 관리할지 애매하므로 룰을 정함
=> 연관관계의 주인

> 1:N관계에서  N이 1을 참조해야 한다.
> 이는 mappedBy 속성을 사용하여 지정할 수 있는데, 주인이 아닌 쪽에서 주인을 지정한다고 생각하면 좋다. (mappedBy의 단어 자체가 매핑당한다는 의미이므로)

따라서 양방향 연관관계는 연관관계의 주인이 외래 키를 관리한다.

양방향 연관관계가 주인이 아닌 쪽에서 수정이 안됨 

> 양방향 매핑시 가장 많이 하는 실수
> => 연관관계의 주인에 값을 입력하지 않음

ex)
```java
// 회원에 팀을 저장할 때 
member.setTeam(team) // 연관관계 설정(연관관계의 주인) 
// 팀에 회원을 저장할 때 
team.getMembers().add(member); // 무시(연관관계의 주인X)
```


![[Pasted image 20231105111212.png]]
![[Pasted image 20231105111910.png]]


## 양방향 연관관계시에 주의해야할 점
### 순수 객체 상태를 고려해서 항상 양쪽에 값을 설정하자
순수한 객체로서의 연관관계까지 고려한다면, 객체 관점에서는 위와 같이 양쪽 방향에 모두 값을 입력해주는 것이 가장 안전하다. 양쪽 방향 모두 값을 입력하지 않으면 JPA를 사용하지 않는 순수한 객체 상태에서 심각한 문제가 발생할 수 있다.
### 연관관계 편의 메서드를 생성하자
```java
public void setTeam(Team team){
	this.team = team;
	team.getMembers().add(this);
}
```
이렇게 만들어서 항상 양쪽에 값을 설정해줄 수 있도록 하자!
### 양방향 매핑시에 무한 루프를 조심하자
