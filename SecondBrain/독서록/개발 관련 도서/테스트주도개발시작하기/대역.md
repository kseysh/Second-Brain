테스트를 작성하며 외부 요인이 테스트에 관여하는 주요 예
- 테스트 대상에서 파일 시스템을 사용
- 테스트 대상에서 DB로부터 데이터를 조회하거나 데이터를 추가
- 테스트 대상에서 외부의 HTTP 서버와 통신

### Double
영어로 된 테스트 관련 글에서 test double이라는 표현이 자주 나오는데 여기서 double은 대역을 의미한다.

## 대역을 이용한 테스트

아래 코드에서 StubCardNumberValidator는 대역을 수행하는 클래스로 실제 카드번호 검증 기능을 구현하지 않고, 대신 단순한 구현으로 실제 구현을 대체한다.
![[Pasted image 20231115103246.png]]
![[Pasted image 20231115103312.png]]

아래 코드는 대역을 사용한 테스트 코드이다.
![[Pasted image 20231115094727.png]]
![[Pasted image 20231115103340.png]]
위 코드에서 AutoDebitRegister 객체를 생성할 때 실제 객체 대신에 StubCardNumberValidator을 사용해서 카드번호가 유효한지 검사하게 된다.

반대로 대역을 사용하지 않으면 아래 코드와 같다.
![[Pasted image 20231115094759.png]]

## DB 연동 코드에서 대역을 사용한 테스트
![[Pasted image 20231115103914.png]]
위 코드는 DB 대신 맵을 이용해서 자동이체 정보를 저장한다. 메모리에만 데이터가 저장되므로 DB와 같




