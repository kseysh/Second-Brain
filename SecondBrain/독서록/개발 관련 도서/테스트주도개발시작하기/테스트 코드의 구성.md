# 테스트 코드의 구성 요소 : 상황 실행 결과 확인
### 예시
![[Pasted image 20231109095258.png]]
## 상황 (given)
@BeforeEach를 적용하여 상황을 설정할 수도 있다.
상황이 없는 경우도 존재한다
아래 예시와 같은 경우도 결과에 영향을 주는 상황이 존재하지 않으므로 테스트는 다음처럼 기능을 실행하고 결과를 확인하는 코드만 포함한다.
![[Pasted image 20231109095509.png]]
## 실행 (when)

## 결과 확인 (then)
실행 결과를 확인하는 쉬운 방법 => 리턴 값을 사용하여 확인하는 것
하지만 실행 결과로 예외를 발생시키는 것이 정상인 경우도 있다.

> 상황-실행-결과 확인 구조에 너무 집착하지 말자. 이 구조가 테스트 코드를 작성하는데 도움이 되는 것은 맞지만 꼭 모든 테스트 메서드를 이 구조로 만들어야 하는 것은 아니다. 테스트 코드를 보고 테스트 내용을 이해할 수 있으면 된다.

# 외부 상황과 외부 결과
파일이 존재하지 않는 상황에서의 결과를 확인할 때, 존재하지 않는 파일을 경로로 사용할 수 있지만, 우연에 의해 파일이 존재하는 경로일 수도 있다. 이를 방지하기 위해 명시적으로 파일이 없는 상황을 만들어 주는 것이 좋다.
![[Pasted image 20231109100206.png]]
![[Pasted image 20231109100231.png]]
이 테스트에서 `givenNoFile()`메서드는 해당 경로에 파일이 존재하는지 검사해서 존재할 경우 해당 파일을 삭제함으로써 테스트가 항상 올바른 상황에서 동작한다는 것을 보장할 수 있다.

파일이 존재하는 상황은 상황에 알맞은 파일을 미리 만들어 두는 것이 좋다. 다른 개발자도 테스트를 실행할 수 있어야 하므로 테스트에 맞게 준비한 파일은 버전 관리 대상에 추가한다.
파일을 미리 만들지 않고 테스트 코드에서 상황에 맞는 파일을 생성하는 것도 좋은 방법이다.
=> 테스트 코드 안에 필요한 것이 다 있어 테스트 코드에서 상황을 명시적으로 구성하기 때문에 테스트 내용을 이해하기 위해 많은 파일을 볼 필요가 없다.
![[Pasted image 20231109100946.png]]

## 외부 상태가 테스트 결과에 영향을 주지 않게 하기
테스트 코드는 언제 실행해도 항상 정상적으로 동작하는 것이 중요하다. 간헐적으로 실패하거나 다른 테스트 다음에 실행해야 성공하면 테스트 결과에 대한 신뢰성이 떨어진다.

DB를 사용하여 중복 여부를 검증하는 테스트의 경우 생성한 데이터를 다시 삭제하거나 트랜잭션을 롤백하는 방법을 통해 다음 테스트시에 영향을 주지 않도록 한다.

## 외부 상태와 테스트 어려움
상황과 결과에 영향을 주는 외부 요인은 파일, DBMS, 외부 서버 등 다양하다.





