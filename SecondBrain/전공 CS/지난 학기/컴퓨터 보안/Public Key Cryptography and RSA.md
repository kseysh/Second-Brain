## Model of Symmetric Cryptosystem
![[Pasted image 20250506170942.png|300]]
## λ™κΈ°: κ³µκ°ν‚¤ μ•”νΈ μ‹μ¤ν… (Public-Key Cryptosystems)
β€Ά	κ³µκ°ν‚¤ μ•”νΈ λ°©μ‹μ κ°λ…μ€ λ€μΉ­ν‚¤ μ•”νΈν™”(symmetric encryption)μ™€ κ΄€λ ¨λ λ‘ κ°€μ§€ κ°€μ¥ μ–΄λ ¤μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•λ ¤λ” μ‹λ„μ—μ„ λ°μ „ν•¨:
β€Ά	ν‚¤ λ¶„λ°°
	β€Ά	key distribution center(KDC)λ¥Ό μ‹ λΆ°ν•μ§€ μ•κ³ λ„ μΌλ°μ μΈ μƒν™©μ—μ„ μ•μ „ν• ν†µμ‹ μ„ ν•λ” λ°©λ²•
β€Ά	λ””μ§€ν„Έ μ„λ…
	β€Ά	λ©”μ‹μ§€κ°€ μ£Όμ¥λ λ°μ‹ μλ΅λ¶€ν„° μ¨ κ²ƒμ„μ„ ν™•μΈν•λ” λ°©λ²•
β€Ά	Diffieμ™€ Hellmanμ€ μ΄ λ‘ λ¬Έμ λ¥Ό ν•΄κ²°ν•κ³  κΈ°μ΅΄μ μ•”νΈ λ°©μ‹λ“¤κ³Όλ” μ „ν€ λ‹¤λ¥Έ λ°©μ‹μ„ μ μ‹ν•μ—¬ ν° μ§„μ „μ„ μ΄λ£Έ
## κ³µκ° ν‚¤ μ•”νΈ μ‹μ¤ν…μ μ„Έ κ°€μ§€ ν•µμ‹¬ λ©μ 
- κΈ°λ°€μ„±
- μΈμ¦
- μΈμ¦ + κΈ°λ°€μ„±
## Public Key Cryptosystem: Confidentiality
![[Pasted image 20250506171757.png|500]]
PU: public keyλ΅ λ¨λ“  μ‚¬λμ—κ² λ‚λ„μ–΄μ£Όλ” ν‚¤
PR: private key
X: plain text
Y: Cipher text

λ©”μ‹μ§€λ¥Ό νƒ€μΈμΌλ΅λ¶€ν„° μ¨κΈ°κΈ° μ„ν•΄, μμ‹ μμ κ³µκ°ν‚¤λ΅ μ•”νΈν™”
μ†΅μ‹ μ A: Y = E(PU<sub>b</sub>, X)
μμ‹ μ B: X = D(PR<sub>b</sub>, Y)
μ•”νΈλ¥Ό ν•΄λ…ν•κ³ μ ν•λ‹¤λ©΄, PR<sub>b</sub>μ™€ cipher textκ°€ μμ–΄μ•Ό ν•΄λ…ν•  μ μμΌλ―€λ΅ κΈ°λ°€μ„± λ§μ΅±
## μ „ν†µμ  μ•”νΈν™” vs κ³µκ°ν‚¤ μ•”νΈν™”

|          | μ „ν†µμ  μ•”νΈν™”                                                                                              | κ³µκ°ν‚¤ μ•”νΈν™”                                                                                                                 |
| -------- | ---------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| λ™μ‘<br>μ΅°κ±΄ | 1. μ•”νΈν™”μ™€ λ³µνΈν™”μ— κ°™μ€ μ•κ³ λ¦¬μ¦κ³Ό ν‚¤ μ‚¬μ©<br>2. μ†΅μ‹ μμ™€ μμ‹ μκ°€ μ•κ³ λ¦¬μ¦κ³Ό ν‚¤λ¥Ό κ³µμ ν•΄μ•Ό ν•¨                                           | 1. μ•”νΈν™”μ™€ λ³µνΈν™”μ— κ°κ° μ—°κ΄€λ λ‹¤λ¥Έ μ•κ³ λ¦¬μ¦ μ‚¬μ© <br>(μμΌλ΅ λ ν‚¤ μ¤‘ ν•λ‚μ”© μ‚¬μ©)<br>2. μ†΅μ‹ μμ™€ μμ‹ μλ” μ„λ΅ λ‹¤λ¥Έ ν‚¤ ν• μμ„ λ³΄μ ν•΄μ•Ό ν•¨                               |
| λ³΄μ•<br>μ΅°κ±΄ | 1. ν‚¤λ” λΉ„λ°€λ΅ μ μ§€λμ–΄μ•Ό ν•¨<br>2. ν‚¤κ°€ λΉ„λ°€μ΄λ©΄ λ©”μ‹μ§€λ¥Ό ν•΄λ…ν•λ” κ²ƒμ΄ λ¶κ°€λ¥ν•κ±°λ‚ λΉ„ν„μ‹¤μ μ΄μ–΄μ•Ό ν•¨<br>3. μ•κ³ λ¦¬μ¦κ³Ό μ•”νΈλ¬Έ μƒν”μ„ μ•μ•„λ„ ν‚¤λ¥Ό μ¶”λ΅ ν•  μ μ—†μ–΄μ•Ό ν•¨ | 1. λ‘ ν‚¤ μ¤‘ ν•λ‚λ” λΉ„λ°€λ΅ μ μ§€λμ–΄μ•Ό ν•¨<br>2. λΉ„λ°€ ν‚¤κ°€ μ μ§€λλ©΄ λ©”μ‹μ§€λ¥Ό ν•΄λ…ν•λ” κ²ƒμ΄ λ¶κ°€λ¥ν•κ±°λ‚ λΉ„ν„μ‹¤μ μ΄μ–΄μ•Ό ν•¨<br>3. μ•κ³ λ¦¬μ¦, ν‚¤ ν•λ‚, μ•”νΈλ¬Έ μƒν”μ„ μ•μ•„λ„ λ‹¤λ¥Έ ν‚¤λ¥Ό μ μ¶”ν•  μ μ—†μ–΄μ•Ό ν•¨ |
## Public Key Cryptosystem: Authentication
![[Pasted image 20250506173844.png|500]]
λ©μ : λ©”μ‹μ§€κ°€ μ†΅μ‹ μ Aμ— μν•΄ μƒμ„±λμ—μμ„ μ¦λ…ν•κΈ° μ„ν•΄, μ†΅μ‹ μμ κ°μΈν‚¤λ΅ μ„λ… (λ¶€μΈ λ°©μ§€ κΈ°λ¥)

- μ†΅μ‹ μ Aλ” λ©”μ‹μ§€ Xλ¥Ό μμ‹ μ κ°μΈν‚¤ PR<sub>a</sub>λ΅ μ•”νΈν™” Y = E(PR<sub>a</sub>, X)
	- λ³΄λ‚΄λ” μ‚¬λμ€ μμ‹ μ private keyλ¥Ό κ°€μ§€κ³  μ„λ…
- μμ‹ μ Bλ” μ†΅μ‹ μμ κ³µκ°ν‚¤ PUaλ΅ λ³µνΈν™” X = D(PU<sub>a</sub>, Y)
	- λ°›λ” μ‚¬λμ€ λ³΄λ‚Έ μ‚¬λμ public keyλ¥Ό κ°€μ§€κ³  μ„λ… ν™•μΈ
- λ³µνΈν™”κ°€ μ„±κ³µν•λ©΄, λ©”μ‹μ§€κ°€ μ†΅μ‹ μ Aλ΅λ¶€ν„° μ¨ κ²ƒμ„μ„ μΈμ¦ν•  μ μμ
- μ„λ…μ€ μμ‹ λ§ ν•  μ μκ³ , μ„λ… ν™•μΈμ€ λ¨λ‘κ°€ ν•  μ μμ
- MACκ³Ό λ‹¬λ¦¬ λ¶€μΈ λ°©μ§€ κΈ°λ¥μ΄ μ¶”κ°€λλ‹¤ (μ„λ… μƒμ„±μ€ λ³΄λ‚΄λ” μ‚¬λλ§ κ°€λ¥ν•λ―€λ΅)
κ·Έλ¦Ό μ™Έμ°κΈ°
## Cryptosystem: Authentication and Confidentiality
![[Pasted image 20250506174659.png|500]]
1. μ†΅μ‹ μ Aλ” λ©”μ‹μ§€ Xλ¥Ό μμ‹ μ PRaλ΅ μ•”νΈν™” Y = E(PR<sub>a</sub>, X)
	- μ„λ… μƒμ„±
2. Yλ¥Ό λ‹¤μ‹ μμ‹ μ Bμ PU<sub>b</sub>λ΅ μ•”νΈν™” Z = E(PU<sub>b</sub>, Y)
	- κΈ°λ°€μ„±
3. μμ‹ μ Bλ” μμ‹ μ PR<sub>b</sub>λ΅ λ³µνΈν™” Y = D(PR<sub>b</sub>, Z)
	- κΈ°λ°€μ„± λ³µνΈν™”
4. μμ‹ μ Bλ” Aμ PUaλ΅ λ³µνΈν™” X = D(PU<sub>a</sub>, Y)
	- μ„λ… κ²€μ¦
μ†΅μ‹ μ μμ‹ μμ private, public keyκ°€ μ–΄λ–¤ λ©μ μ„ κ°€μ§€κ³  μ‚¬μ©λλ”μ§€ μ μ•μ•„μ•Ό ν•λ‹¤.

=> κµ‰μ¥ν μ¤‘μ”ν• κ°λ…
κ·Έλ¦Ό μ™Έμ°κΈ°

### μ •λ¦¬
| **λ©μ **                               | **μ•”νΈν™” ν‚¤**                       | **λ³µνΈν™” ν‚¤**                       | **λ³΄μ¥λλ” λ³΄μ• κΈ°λ¥** |
| ------------------------------------ | ------------------------------- | ------------------------------- | -------------- |
| 9.2 Confidentiality                  | PU<sub>b</sub>                  | PR<sub>b</sub>                  | κΈ°λ°€μ„±            |
| 9.3 Authentication                   | PR<sub>a</sub>                  | PU<sub>a</sub>                  | μΈμ¦ (λ¶€μΈ λ°©μ§€)     |
| 9.4 Authentication + Confidentiality | PR<sub>a</sub> β†’ PU<sub>b</sub> | PR<sub>b</sub> β†’ PU<sub>a</sub> | κΈ°λ°€μ„± + μΈμ¦       |
## κ³µκ°ν‚¤ μ•”νΈ μ‹μ¤ν…μ μ‘μ© λ¶„μ•Ό
β€Ά	μ„Έ κ°€μ§€ λ²”μ£Όλ΅ λ¶„λ¥λ¨:
β€Ά	μ•”νΈν™”/λ³µνΈν™”: μ†΅μ‹ μκ°€ μμ‹ μμ κ³µκ°ν‚¤λ΅ λ©”μ‹μ§€λ¥Ό μ•”νΈν™”
β€Ά	λ””μ§€ν„Έ μ„λ…: μ†΅μ‹ μκ°€ μμ‹ μ κ°μΈν‚¤λ΅ λ©”μ‹μ§€μ— μ„λ…
β€Ά	ν‚¤ κµν™: μ–‘μΈ΅μ΄ ν‘λ ¥ν•μ—¬ μ„Έμ… ν‚¤λ¥Ό κµν™
β€Ά	μΌλ¶€ μ•κ³ λ¦¬μ¦μ€ μ„Έ κ°€μ§€ μ©λ„ λ¨λ‘μ— μ ν•©ν•κ³ , μΌλ¶€λ” ν• λ‘ κ°€μ§€ μ©λ„μ—λ§ μ ν•©
![[Pasted image 20250506175832.png|300]]
DSS: digital signature standard
## κ³µκ°ν‚¤ μ•”νΈ μ‹μ¤ν…μ μ”κµ¬μ‚¬ν•­
β€Ά	B μ‚¬μ©μκ°€ κ³µκ°ν‚¤(Pub)μ™€ κ°μΈν‚¤(Prv)λ¥Ό μƒμ„±ν•λ” κ²ƒμ΄ κ³„μ‚°μ μΌλ΅ μ‰¬μ›μ•Ό ν•¨
β€Ά	A μ‚¬μ©μκ°€ κ³µκ°ν‚¤μ™€ λ©”μ‹μ§€λ¥Ό μ•κ³  μμ„ λ• μ•”νΈλ¬Έμ„ μƒμ„±ν•λ” κ²ƒμ΄ μ‰¬μ›μ•Ό ν•¨
β€Ά	B μ‚¬μ©μκ°€ κ°μΈν‚¤λ΅ μ•”νΈλ¬Έμ„ λ³µνΈν™”ν•μ—¬ μ›λ¬Έμ„ μ–»λ” κ²ƒμ΄ μ‰¬μ›μ•Ό ν•¨
=> μ •λ‹Ήν• μ‚¬μ©μλ” κ³„μ‚°μ΄ μ‰¬μ›μ•Ό ν•λ‹¤
β€Ά	κ³µκ²©μκ°€ κ³µκ°ν‚¤λ§ μ•κ³  μμ„ λ• κ°μΈν‚¤λ¥Ό μ•μ•„λ‚΄λ” κ²ƒμ΄ κ³„μ‚°μ μΌλ΅ λ¶κ°€λ¥ν•΄μ•Ό ν•¨
β€Ά	κ³µκ²©μκ°€ κ³µκ°ν‚¤μ™€ μ•”νΈλ¬Έμ„ μ•κ³  μμ„ λ• μ›λ¬Έμ„ μ•μ•„λ‚΄λ” κ²ƒμ΄ κ³„μ‚°μ μΌλ΅ λ¶κ°€λ¥ν•΄μ•Ό ν•¨
=> μ •λ‹Ήν•μ§€ μ•μ€ μ‚¬μ©μλ” κ³„μ‚°μ΄ μ–΄λ ¤μ›μ•Ό ν•λ‹¤.
## RSA μ•κ³ λ¦¬μ¦
β€Ά	1977λ…„ MITμ Ron Rivest, Adi Shamir, Len Adlemanμ΄ κ°λ°
β€Ά	κ°€μ¥ λ„λ¦¬ μ‚¬μ©λλ” λ²”μ© κ³µκ°ν‚¤ μ•”νΈ λ°©μ‹
β€Ά	ν‰λ¬Έκ³Ό μ•”νΈλ¬Έμ€ 0λ¶€ν„° n-1κΉμ§€μ μ •μ
β€Ά	μΌλ°μ μΈ nμ ν¬κΈ°λ” 1024λΉ„νΈ(10μ§„μλ΅ μ•½ 309μλ¦¬)
![[Pasted image 20250506180244.png|500]]
Recall:
	1.	Euler totient function π™(π‘›)
	β€Ά	π‘› μ΄ν•μ μ–‘μ μ •μ μ¤‘ π‘›κ³Ό μ„λ΅μ†μΈ μμ κ°μ
	2.	μ¤μΌλ¬ μ •λ¦¬
	β€Ά	aμ™€ nμ΄ μ„λ΅μ†μΌ λ•:
β€ƒβ€ƒa<sup>π™(n)</sup> β‰΅ 1 (mod n)
μ •λ‹Ήμ„± μ¦λ…:
λ‹¨μν™”λ¥Ό μ„ν•΄, gcd(π‘€, π‘›) = 1 μΈ κ²½μ°λ§ κ³ λ ¤ν•λ‹¤.
π‘’π‘‘ = π‘π™(π‘›) + 1 μ΄ λλ” μ–΄λ–¤ π‘κ°€ μ΅΄μ¬ν•λ‹¤κ³  ν•μ.
π¶<sup>π‘‘</sup> mod π‘› = (π‘€<sup>π‘’</sup> mod π‘›)<sup>π‘‘</sup> mod π‘› => C = π‘€<sup>π‘’</sup> mod π‘› μ΄λ―€λ΅
β€ƒβ€ƒβ€ƒβ€ƒβ€ƒβ€ƒ= π‘€<sup>π‘’π‘‘</sup> mod π‘› => mod μ—°μ‚°μ μ„±μ§λ΅ μ΄λ ‡κ² ν‘ν„ κ°€λ¥
β€ƒβ€ƒβ€ƒβ€ƒβ€ƒβ€ƒ= π‘€<sup>π‘π™(π‘›)</sup>Γ— π‘€ mod π‘›
β€ƒβ€ƒβ€ƒβ€ƒβ€ƒβ€ƒ= (π‘€<sup>π™(π‘›)</sup>)<sup>π‘</sup> Γ— π‘€ mod π‘› = π‘€ => Euler totient functionμ— μν•΄ π‘€<sup>π™(π‘›)</sup> = 1
=> Mμ„ e μ κ³±ν•΄μ„ cipher textλ¥Ό λ§λ“¤κ³ , μ΄λ¥Ό d μ κ³±μ„ λ‹¤μ‹ν•κ² λλ©΄ μ›λ Mμ΄ λμ•„μ¨λ‹¤.
```python
def keygen(keylen):
    bound = 1 << keylen//2 
    p = 2 * random.randint(bound//4, bound//2) - 1
    while miller_rabin(p, 50) == Composite:
        p = 2 * random.randint(bound//4, bound//2) - 1
    q = 2 * random.randint(bound//4, bound//2) - 1 
    while miller_rabin(q, 50) == Composite:
        q = 2 * random.randint(bound//4, bound//2) - 1
    # Now p and q are odd primes.
    # Compute n.
    n = p * q
    # find e appropriately.
    a = (p - 1) * (q - 1)
    e = random.randint(3, a)
    while gcd(e, a) != 1:
        e = random.randint(3, a)
    # find d appropriately.
    d = pow(e, -1, a)
    # Hint: You may compute x^-1 mod m by pow(x, -1, m)
    return (e, d, n)
```
#### RSA Algorithm Example
![[Pasted image 20250506182828.png|500]]
p = 17
q = 11
π™(π‘›)  160
e = 7
d = 23

λ§μ•½ mod 187μ—μ„ plain textκ°€ 189λΌλ©΄, decryptionμ΄ν›„ κ°’μ€ 2κ°€ λμ–΄λ²„λ ¤ λ‹¤λ¥Έ κ°’μ΄ λ‚μ¬ μ μλ‹¤
## Mμ΄ nλ³΄λ‹¤ ν΄ λ•, ν•΄κ²° λ°©λ²• λ‘ κ°€μ§€

### RSA Processing of Multiple Blocks
![[Pasted image 20250519213550.png|200]]
RSAλ΅ κΈ΄ λ©”μ‹μ§€λ¥Ό μ²λ¦¬ν•  λ•, ECB λ¨λ“μ²λΌ λ©”μ‹μ§€λ¥Ό λΈ”λ΅μΌλ΅ λ‚λ  κ°κ° μ•”νΈν™” ν•λ‹¤.
ν‚¤ μƒμ„± ν›„ ν‰λ¬Έ Pλ¥Ό λΈ”λ΅ λ‹¨μ„λ΅ λ‚λ  κ° λΈ”λ΅ P<sub>i</sub>λ¥Ό C<sub>i</sub> = P<sub>i</sub><sup>e</sup>mod nμΌλ΅ μ•”νΈν™”ν•λ‹¤
 μμ‹ μλ” κ°μΈν‚¤λ΅ P<sub>i</sub> = C<sub>i</sub><sup>d</sup>mod nμΌλ΅ λ³µνΈν™”
=> λ„λ¬΄ μ—°μ‚°μ΄ μ‹κ°„μ΄ μ¤λκ±Έλ¦¬κ² λμ–΄ μ΄λ ‡κ² μ μ‚¬μ©ν•μ§€λ” μ•λ”λ‹¤.
### Hybrid encryption - key encapsulation + Data encryption
![[Pasted image 20250519213522.png|300]]
RSA λ‹¨λ… μ‚¬μ©μ€ λλ¦¬κΈ° λ•λ¬Έμ—, μ‹¤λ¬΄μ—μ„λ” λ€μΉ­ν‚¤(AES)μ™€ κ³µκ°ν‚¤(RSA)λ¥Ό κ²°ν•©ν•λ” ν•μ΄λΈλ¦¬λ“ μ•”νΈν™”λ¥Ό μ‚¬μ©ν•λ‹¤
###### μ†΅μ‹ μ Bob
1. μ†΅μ‹ μ Bobμ΄ μ„Έμ… ν‚¤ K μƒμ„±
2. RSAλ΅ K μ•”νΈν™” C = K<sup>e</sup> mod n
3. CTR λ¨λ“λ΅ λ°μ΄ν„° μ•”νΈν™”
	- ν‰λ¬Έ P1, P2...λ¥Ό AES-CTR κ°™μ€ λ€μΉ­ ν‚¤ μ•κ³ λ¦¬μ¦μΌλ΅ μ•”νΈν™”
4. μ•”νΈλ¬Έ C, C1, C2....μ„ Aliceμ—κ² μ „μ†΅
###### μμ‹ μ Alice
1. μ„Έμ… ν‚¤ λ³µνΈν™” K = C<sup>d</sup>mod n
2. λ°μ΄ν„° λ³µνΈν™”
	- λ™μΌν• CTR λ¨λ“ μ‚¬μ©
	- P1, P2, PN λ³µμ›
## RSA encryption vs. digital signature
![[Pasted image 20250506185921.png|400]]
### RSA digital signature
![[Pasted image 20250506190031.png|400]]
λ©”μ‹μ§€ Mκ³Ό μ „μμ„λ… Sλ¥Ό κ°™μ΄ λ³΄λƒ„
Aliceμ κ³µκ°ν‚¤ e,nμ„ κ°€μ§€κ³  M,Sλ¥Ό μ„λ…ν™•μΈ ν•  μ μμ–΄ λ¶€μΈ λ°©μ§€κ°€ κ°€λ¥ν•λ‹¤
μ¶”κ°€μ μΌλ΅ Mκ³Ό M'μ΄ κ°™λ‹¤λ” κ²ƒμ„ μ•λ©΄ λ¬΄κ²°μ„±λ„ ν™•μΈ κ°€λ¥ν•λ‹¤.
## λ¨λ“λ¬ μ‚°μ μ—μ„μ μ§€μ κ³„μ‚°
β€Ά	RSAμ—μ„ μ•”νΈν™”, λ³µνΈν™”, μ„λ… μƒμ„± λ° κ²€μ¦μ€ λ¨λ‘ μ •μλ¥Ό μ§€μ μ κ³±ν• ν›„ mod nμ„ μ·¨ν•¨
β€Ά	λ¨λ“λ¬ μ—°μ‚°μ μ„±μ§ μ‚¬μ© κ°€λ¥: (a mod n) Γ— (b mod n)] mod n = (a Γ— b) mod n
β€Ά	μ§€μκ°€ λ§¤μ° ν¬κΈ° λ•λ¬Έμ— μ§€μ μ—°μ‚°μ ν¨μ¨μ„± μ¤‘μ”
### Algorithm for Computing a<sup>b</sup> mod n (Binary modular exponentiation / Square and Multiply method)
![[Pasted image 20250506190719.png|400]]
a = 7
b = 560
n = 561
μ΄κ³ , 560μ€ 10bitλ΅ ν‘ν„λλ©° λ”°λΌμ„ k = 9κ°€ λλ‹¤.
cλ” νΉμ • λΉ„νΈκΉμ§€μ κ°’μ„ 10μ§„μλ΅ ν‘ν„ν•κ²ƒ, ex) iκ°€ 4μΌ λ• 100011μ΄λ©°, μ΄λ” μ‹­μ§„μλ΅ 35λ΅ ν‘ν„λ¨
7<sup>1</sup>μ„ μ΄μ©ν•΄ 7<sup>10</sup>μ„ λ§λ“¤κ³  μ΄λ¥Ό μ΄μ©ν•΄ 7<sup>1000110000</sup>μ„ λ§λ“λ” λ°©λ²•μ„
λ³µμ΅λ„ -> λΉ„νΈ μλ¦¬ μ μ •λ„λ§ ν•λ―€λ΅ k bitλΌλ©΄, k x 3/2 μ •λ„μ κ³±μ…μ„ ν•κ² λλ‹¤.
```python
def exp(a, b, n):
    f = 1
    bin_b = int_to_bin(b)
    k = len(bin_b)
    for i in range(k):   # Fill this part.
        f = (f * f) % n
        if bin_b[i] == '1':
            f = (f * a) % n
    return f
```
μ„ μ¬λΌμ΄λ“μ—μ„ cλ” μ–΄μ°¨ν”Ό λ³΄μ—¬μ£ΌκΈ° μ©μΌλ΅ ν„μ¬ aμ λ‡ μ κ³±μ„ κ³„μ‚°ν•κ³  μλ”μ§€λ¥Ό λ³΄μ—¬μ¤€λ‹¤. λ”°λΌμ„ cλ” κµ¬ν„ν•μ§€ μ•μ•λ‹¤.
## κ³µκ°ν‚¤λ΅μ ν¨μ¨μ  μ—°μ‚°
β€Ά	RSAμ—μ„ κ³µκ°ν‚¤ μ‚¬μ© μ‹ μ†λ„λ¥Ό λ†’μ΄κΈ° μ„ν•΄ e κ°’μ€ λ³΄ν†µ νΉμ • κ°’μΌλ΅ μ„¤μ •
β€Ά	κ°€μ¥ μΌλ°μ μΈ κ°’: 65537 (2ΒΉβ¶ + 1)
	β€Ά	λ‹¤λ¥Έ κ°’λ“¤: e = 3, e = 17
	β€Ά	μ΄ κ°’λ“¤μ€ 1 λΉ„νΈκ°€ μ μ–΄ κ³±μ… νμκ°€ μµμ†ν™”λ¨
	β€Ά	λ‹¨, e = 3μ²λΌ λ„λ¬΄ μ‘μ€ eλ” κ°„λ‹¨ν• κ³µκ²©μ— μ·¨μ•½
## κ°μΈν‚¤λ΅μ ν¨μ¨μ  μ—°μ‚°
β€Ά	λ³µνΈν™”λ” d μ κ³± μ—°μ‚° ν¬ν•¨
	β€Ά	dκ°€ μ‘μΌλ©΄ brute force λ“± λ‹¤μ–‘ν• κ³µκ²©μ— μ·¨μ•½ (κ·Έλμ„ dλ” μ‘κ² ν•λ©΄ μ•λ¨)
β€Ά	κ³„μ‚° μ†λ„λ¥Ό λ†’μ΄κΈ° μ„ν•΄ μ¤‘κµ­μΈμ λ‚λ¨Έμ§€ μ •λ¦¬(CRT) μ‚¬μ© κ°€λ¥
	β€Ά	d mod (p-1), d mod (q-1)μ„ λ―Έλ¦¬ κ³„μ‚°
	β€Ά	μ§μ ‘ κ³„μ‚°λ³΄λ‹¤ μ•½ 4λ°° λΉ λ¥΄κ² μ²λ¦¬ κ°€λ¥
## RSAμ λ³΄μ•
β€Ά	RSAμ— λ€ν• κ³µκ²© λ°©μ‹ 5κ°€μ§€:
	β€Ά	Brute force: κ°€λ¥ν• λ¨λ“  κ°μΈν‚¤ μ‹λ„
	β€Ά	Mathematical attacks: λ‘ μ†μμ κ³±μ„ μΈμλ¶„ν•΄
	β€Ά	Chosen ciphertext attacks (CCA): RSAμ λ™ν•μ„± μ†μ„± μ•…μ©
	β€Ά	Implementation attacks: 
		β€Ά	side-channel
			μ: μ‹κ°„ λ¶„μ„, μ „λ ¥ λ¶„μ„
		β€Ά	Hardware fault-based attack
			β€Ά	λ³µνΈν™” λλ” μ„λ… μ¤‘μΈ ν”„λ΅μ„Έμ„μ— μΈμ„μ  μ¤λ¥ μ λ„
## Factoring Problem
![[Pasted image 20250508153122.png|300]]
β€Ά	RSA κ³µκ²©μ„ μ„ν• μν•™μ  μ ‘κ·Ό 3κ°€μ§€:
1. nμ„ μ†μΈμ λ¶„ν•΄ν•λ” λ°©λ²•
	- n = p x qμ λ‘ μ†μλ΅ λ¶„ν•΄ν•λ©΄,
	- μ¤μΌλ¬ ν•¨μ Ο†(n) = (p-1)(q-1)λ¥Ό κ³„μ‚° ν•  μ μμ
	- μ΄ κ°’μ„ ν†µν•΄ λΉ„λ°€ ν‚¤ dλ¥Ό e<sup>-1</sup>mod Ο†(n)λ΅ κ³„μ‚° κ°€λ¥
2. p, q μ—†μ΄ Ο†(n) μ§μ ‘ κ³„μ‚°ν•λ” λ°©λ²•
	- μ΄λ΅ μ μΌλ΅λ” κ°€λ¥ν•μ§€λ§, ν„μ‹¤μ—μ„λ” Ο†(n) μμ²΄λ„ pμ™€ qλ¥Ό μ•μ•„μ•Ό κµ¬ν•  μ μκΈ° λ•λ¬Έμ— μ–΄λ ¤μ›€
	- μ°νμ μΈ λ°©μ‹μΌλ΅ Ο†(n)λ¥Ό κµ¬ν•  μ μλ‹¤λ©΄ μ—­μ‹ dλ¥Ό κ³„μ‚°ν•  μ μμ
3.	Ο†(n) μ—†μ΄ dλ¥Ό μ§μ ‘ κ³„μ‚°
	- κ°€μ¥ μ–΄λ ¤μ΄ λ°©μ‹μ΄λ©° dλ¥Ό κµ¬ν•  μ μλ‹¤λ©΄ RSAκ°€ κΉ¨μ§„ κ²ƒ
## Chosen Ciphertext Attack (CCA) 
β€Ά	κ³µκ²©μλ” μ—¬λ¬ κ°μ μ•”νΈλ¬Έμ„ μ„ νƒν•κ³ , ν•΄λ‹Ή μ•”νΈλ¬Έμ„ νƒ€κ²μ κ°μΈ ν‚¤λ΅ λ³µνΈν™”ν• ν‰λ¬Έμ„ μ κ³µλ°›λ”λ‹¤.
	β€Ά	μ¦‰, κ³µκ²©μλ” μ„μμ ν‰λ¬Έμ„ μ„ νƒν•΄ νƒ€κ²μ κ³µκ° ν‚¤λ΅ μ•”νΈν™”ν•κ³ , μ΄λ¥Ό λ‹¤μ‹ κ°μΈ ν‚¤λ΅ λ³µνΈν™”ν•¨μΌλ΅μ¨ ν‰λ¬Έμ„ μ–»μ„ μ μλ‹¤Β 
		(μ΄ κ³Όμ •μ„ query to decryption oracleλΌκ³  λ¶€λ¦„)
	β€Ά	κ³µκ²©μλ” RSAμ νΉμ„±μ„ μ•…μ©ν•΄, νƒ€κ²μ κ°μΈ ν‚¤λ΅ μ²λ¦¬ν–μ„ λ• μ•”νΈ ν•΄λ…μ— ν•„μ”ν• μ •λ³΄λ¥Ό μ–»μ„ μ μλ” λ°μ΄ν„° λΈ”λ΅μ„ μ„ νƒν•λ‹¤.
RSA νΉμ„±: RSAμ—μ„λ” μ•”νΈλ¬ΈλΌλ¦¬μ μ—°μ‚°μ΄ Plaintext μ—°μ‚° ν›„ μ•”νΈν™”μ™€ κ°™μ€ μ—°μ‚°μ΄ λ‚μ¤λ” λ™ν•μ„±μ§μ΄ μλ‹¤.
#### example
β– κ³µκ²©μμ λ©ν‘λ” κ°μΈ ν‚¤ d μ—†μ΄ μ•”νΈλ¬Έ Cλ¥Ό λ³µνΈν™”ν•λ” κ²ƒ
β– κ³µκ²©μλ” C' = C X 2<sup>e</sup> mod nμ„ κ³„μ‚°ν• ν›„, decryption oracleμ— C'μ„ λ³µνΈν™”ν•΄λ‹¬λΌκ³  μ”μ²­ν•΄ M' = C'<sup>d</sup> mod nμ„ μ–»λ”λ‹¤.
	μ•”νΈλ¬Έμ„ μ‚΄μ§ λ°”κΏ”μ„ μƒλ΅μ΄ μ•”νΈλ¬Έμ„ λ§λ“¤μ–΄ λ³µνΈν™”λ¥Ό μ”μ²­ν•¨
	μ΄λ¥Ό μν•™μ μΌλ΅ κ³„μ‚°ν•λ©΄ μ›λ λ©”μ‹μ§€ Mμ„ μ•μ•„λ‚Ό μ μμ
β– κ·Έλ° λ‹¤μ, κ³µκ²©μλ” M' X 2<sup>-1</sup> mod nμ„ κ³„μ‚°ν•λ‹¤.
β€Ά	μ΄λ¬ν• κ³µκ²©μ„ λ°©μ§€ν•κΈ° μ„ν•΄, RSA Security Inc.λ” ν‰λ¬Έμ„ OAEP(μµμ  λΉ„λ€μΉ­ μ•”νΈν™” ν¨λ”©)μ΄λΌλ” μ μ°¨λ¥Ό μ΄μ©ν•΄ μμ •ν•  κ²ƒμ„ κ¶μ¥ν•λ‹¤.
## Encryption Using Optimal Asymmetric Encryption Padding (OAEP)
![[Pasted image 20250508153448.png|400]]
C = (EM)<sup>e</sup> mod n
## side-channel Attacks
![[Pasted image 20250508153623.png|400]]
β€Ά	μ•”νΈ μ „λ¬Έκ°€ Paul Kocherκ°€ κ°λ°
β€Ά	RSAλΏ μ•„λ‹λΌ λ‹¤λ¥Έ κ³µκ°ν‚¤ λ°©μ‹μ—λ„ μ μ©λ¨
β€Ά	νΉμ§•:
	β€Ά	μμƒν•μ§€ λ»ν• λ°©μ‹μΌλ΅ μ΄λ£¨μ–΄μ§
	β€Ά	μ•”νΈλ¬Έλ§μΌλ΅ κ³µκ²© κ°€λ¥
β€Ά	λ€μ‘μ±…:
	β€Ά	ν‚¤μ— λ…λ¦½μ μΈ μ—°μ‚° (μ: μΌμ •ν• μ‹κ°„μ μ§€μ κ³„μ‚°)
	β€Ά	λ¬΄μ‘μ„μ„± λ„μ… (μ: λ¬΄μ‘μ„ μ§€μ—°)
## Fault-Based Attack
β€Ά	RSA μ„λ…μ„ μƒμ„± μ¤‘μΈ ν”„λ΅μ„Έμ„λ¥Ό κ³µκ²©
	β€Ά	μ „λ ¥μ„ μ¤„μ—¬ κ³„μ‚° μ¤‘ μ¤λ¥λ¥Ό μ λ„
	β€Ά	μλ»λ μ„λ… κ²°κ³Όλ¥Ό λ¶„μ„ν•΄ κ°μΈν‚¤ μ μ¶”
β€Ά	μ•κ³ λ¦¬μ¦μ€ λ‹¨μΌ λΉ„νΈ μ¤λ¥λ¥Ό μ λ„ν•κ³  κ²°κ³Όλ¥Ό κ΄€μ°°ν•¨

![[Pasted image 20250513160207.png|300]]
### Chinese Remainder Theorem
- chinese Remainder Theoremμ„ μ΄μ©ν•΄ μ—°μ‚°μ λ³µμ΅λ„λ¥Ό 4λ°°κΉμ§€ μ¤„μΌ μ μλ‹¤.

- κ³Όμ •
	- λΉ„λ°€ ν‚¤λ¥Ό d<sub>p</sub> = d mod (p-1), d<sub>q</sub> = m<sup>d<sub>q</sub></sup> mod qλ΅ λ‚λλ‹¤.
	- κ°κ°μ μ„λ…μ„ μ•„λμ™€ κ°™μ΄ κ³„μ‚°ν•  μ μλ‹¤
		- s<sub>p</sub> = m<sup>d<sub>q</sub></sup> mod p, s<sub>q</sub> = m<sup>d<sub>q</sub></sup> mod q
	- μ „μ²΄ μ„λ…μ€ CRTλ¥Ό μ΄μ©ν•΄ κ²°ν•©ν•λ‹¤
		- s = as<sub>p</sub> + bs<sub>q</sub> mod n
		- ![[Pasted image 20250513160833.png|200]]
### Chinese Remainder Theoremμ„ μ΄μ©ν• Fault Based Attack
κ³µκ²©μκ°€ sp κ³„μ‚° μ¤‘ Faultλ¥Ό μ λ„ν•λ‹¤κ³  κ°€μ •ν•λ©΄, μλ»λ μ„λ… sκ°€ ![[Pasted image 20250513161114.png|200]] μ΅°κ±΄μ„ λ§μ΅±ν•κ² λλ‹¤.
κ³µκ° key (n, e) μ¤‘ eλ¥Ό μ‚¬μ©ν•μ—¬ ![[Pasted image 20250513161145.png|200]]λΌλ” κ²ƒμ„ ν™•μΈν•  μ μκ³  μ΄λ¥Ό ν†µν•΄ gcd(s<sup>e</sup> - m,n) = qλ¥Ό κ³„μ‚°ν•  μ μλ‹¤.
### μ”μ•½
- RSA κ³„μ‚°μ—μ„ N = pqμ— λ€ν•΄, κ³„μ‚°μ„ λ” λΉ λ¥΄κ² ν•κΈ° μ„ν•΄ mod p, mod qλ΅ λ‚λ„μ–΄ μ²λ¦¬ν•  μ μλ‹¤. (CRT μ‚¬μ©)
- κ³µκ²©μκ°€ ν•μ½ λ¨λ“λ¬ μ—°μ‚° (μ: mod p)λ§ μ¤λ¥λ¥Ό μΌμΌν‚¤λ©΄, μ„λ… κ°’μ΄ μλ»λλ©΄μ„, μ΄ μ •λ³΄λ¥Ό μ΄μ©ν•΄ p λλ” q μ¤‘ ν•λ‚λ¥Ό μ¶”μ¶ν•  μ μλ‹¤.
    - κµ¬μ²΄μ μΌλ΅λ”, gcd(s<sup>e</sup> - m,n) = qμ„ κ³„μ‚°ν•μ—¬ q λλ” pλ¥Ό κµ¬ν•  μ μλ‹¤.
    - μ •μƒμ μΈ μ›λμ κ²°κ³Όλ” gcd(s<sup>e</sup> - m,n) = Nμ΄λ‹¤.
## κ³µκ°ν‚¤ μ•”νΈμ— λ€ν• μ¤ν•΄
β€Ά	κ³µκ°ν‚¤ μ•”νΈλ” λ€μΉ­ν‚¤ μ•”νΈλ³΄λ‹¤ ν•­μƒ λ” μ•μ „ν•λ‹¤
β€Ά	κ³µκ°ν‚¤ μ•”νΈμ™€ λ€μΉ­ν‚¤ μ•”νΈλ” ν‚¤ κΈΈμ΄κ°€ κ°™μΌλ©΄ λ³΄μ• μμ¤€λ„ κ°™λ‹¤
	128bit AESλ” brute forceλ¥Ό μ¨μ•Όν•λ”λ°, 2048 bit RSAλ” 2<sup>112</sup>λ³µμ΅λ„λ΅ κΉ¨μ§ μ μμ (FactoringμΌλ΅)
β€Ά	κ³µκ°ν‚¤ μ•”νΈλ” λ²”μ© κΈ°μ λ΅ λ€μΉ­ν‚¤ μ•”νΈλ¥Ό λ€μ²΄ν–λ‹¤
	
β€Ά	κ³µκ°ν‚¤ μ•”νΈλ” ν‚¤ λ¶„λ°°κ°€ κ°„λ‹¨ν•΄μ„ λ€μΉ­ν‚¤ λ°©μ‹μ—μ„ ν•„μ”ν–λ λ³µμ΅ν• ν‚¤ κµν™ μ μ°¨κ°€ λ¶ν•„μ”ν•λ‹¤
	**RSAλ” μƒλ€μ κ³µκ°ν‚¤κ°€ μ •λ§ μƒλ€μ κ³µκ° ν‚¤μΈμ§€ λ¨λ¥΄κΈ° λ•λ¬Έμ— λ³µμ΅ν• ν‚¤ κµν™ μ μ°¨κ°€ ν•„μ”ν•  μ μλ‹¤.**