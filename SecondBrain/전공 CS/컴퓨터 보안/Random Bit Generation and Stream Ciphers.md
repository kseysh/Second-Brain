## Random Numbers
암호화 기반의 여러 네트워크 보안 알고리즘과 프로토콜에서는 랜덤 이진수를 사용한다.
ex) AES용 session key, 대칭 stream encryption
## Randomness
• 숫자 시퀀스가 랜덤한지를 검증하기 위해 두 가지 기준이 사용된다:
	•	균등 분포
		▪ 1과 0의 발생 빈도가 대략 동일해야 한다
	•	독립성
		▪ 시퀀스 내의 어떤 부분 시퀀스도 다른 부분 시퀀스로부터 유추될 수 없어야 한다
## Unpredictability
• 시퀀스의 연속된 값들은 예측할 수 없어야 한다
	•	진정한 랜덤 숫자는 비효율성과 같은 한계가 있기 때문에, 일반적으로는 랜덤처럼 보이는 숫자 시퀀스를 생성하는 알고리즘이 더 자주 사용된다
	•	공격자가 시퀀스의 초기 값을 통해 이후 값을 예측하지 못하도록 주의해야 한다
## Pseudorandom Numbers
• 암호화 관련 응용에서는 일반적으로 알고리즘 기반의 랜덤 숫자 생성 기법을 사용한다
• 이러한 알고리즘은 결정론적이므로 통계적으로 진정한 랜덤은 아니다
• 알고리즘이 충분히 우수하다면 생성된 시퀀스는 여러 랜덤성 테스트를 통과할 수 있으며, 이를 의사 랜덤 숫자라고 한다
## Random and Pseudorandom Number Generators
![[Pasted image 20250417231539.png|400]]
TRNG = true random number generator (진짜 난수 생성기)
PRNG = pseudorandom number generator (의사 난수 생성기)
PRF = pseudorandom function (의사 난수 생성 함수)

## TRNG
• 사실상 랜덤한 소스를 입력으로 사용한다
• 이 소스는 엔트로피 소스라 하며, 컴퓨터의 물리적 환경에서 가져온다
	•	예: 키 입력 타이밍 패턴, 디스크의 전기적 활동, 마우스 움직임, 시스템 시계의 순간 값 등
	•	이러한 소스 또는 소스들의 조합은 랜덤한 이진 출력을 생성하는 알고리즘의 입력이 된다
• TRNG는 아날로그 소스를 단순히 이진으로 변환하거나
• 소스의 bias을 보정하기 위한 추가 처리를 포함할 수도 있다
## PRNG
• 고정된 값인 시드(seed) 를 입력으로 받아, 결정론적 알고리즘을 사용하여 비트 시퀀스를 생성한다
	•	시드는 종종 TRNG를 통해 생성된다
• 출력 비트 스트림은 오직 입력 값(시드 등)에 의해 결정되므로, 알고리즘과 시드를 알고 있는 공격자는 전체 비트 스트림을 재현할 수 있다
• 생성되는 비트 수 외에는 PRNG와 PRF 사이에 차이는 없다
•	의사 랜덤 숫자 생성기 (PRNG)
	•	무한한 비트 시퀀스를 생성하는 알고리즘
	•	대칭 스트림 암호에서 입력으로 사용되는 경우가 대표적인 예다
•	의사 랜덤 함수 (PRF)
	•	고정된 길이의 의사 랜덤 비트 문자열을 생성
	•	예: 대칭 키, nonce (일회성 값)
## Randomness Tests
이 수가 랜덤인지 아닌지를 판별할 수 있는 15개의 테스트 중 3가지
### Frequncy test
▪ 가장 기본적인 테스트이며, 모든 테스트 모음에 반드시 포함되어야 함
▪ 시퀀스 내의 1과 0의 개수가 진정한 랜덤 시퀀스에서 기대되는 수준과 유사한지를 판단하기 위한 것
0과 1의 분포가 특정 퍼센트 이상이면 탈락
### Runs test
▪ 이 테스트의 초점은 시퀀스 내의 전체 런(run) 수에 있음
▪ 런이란, 동일한 비트가 연속적으로 나타나는 구간으로, 앞뒤는 반대값의 비트로 경계 지어짐
▪ 다양한 길이의 1과 0 런의 개수가 랜덤 시퀀스에서 기대되는 수준과 일치하는지를 판단하는 것이 목적
100000000001에서 0의 개수가 일정 개수 이상이면 탈락
### Maurer’s universal statistical test
▪ 초점은 일치하는 패턴 사이의 비트 수에 있음
▪ 시퀀스가 정보 손실 없이 얼마나 압축 가능한지를 감지하는 것이 목적
▪ 유의미하게 압축 가능한 시퀀스는 비랜덤으로 간주됨
0001000100010001 => 0001 x 5 이렇게 압축이 잘 되면 탈락
## Generation of Seed Input to PRNG
![[Pasted image 20250417232906.png|100]]
## 알고리즘 설계
•	알고리즘은 두 가지 범주로 나뉨:
•	전용 알고리즘 (Purpose-built algorithms)
	▪ 의사 난수 비트 스트림 생성을 위해 특별히 설계된 알고리즘
•	기존 암호 알고리즘 기반 알고리즘
	▪ 입력 데이터를 무작위화하는 효과를 가짐
	▪ 일반적인 방법:
		– 대칭 블록 암호
		– 비대칭 암호
		– 해시 함수 및 메시지 인증 코드 (MAC)
## Linear Congruential Generator
•	Lehmer가 처음 제안한 알고리즘으로, 네 개의 수로 매개변수화됨:
	•	m : 모듈러스 (modulus), m > 0
	•	a : 곱셈 계수 (multiplier), 0 < a < m
	•	c : 증가값 (increment), 0 ≤ c < m
	•	X<sub>0</sub> : 시작 값 또는 시드 (seed), 0 ≤ X<sub>0</sub> < m
•	난수의 수열 \{X<sub>n</sub>\}은 다음과 같은 반복 방정식으로 생성됨:
	X<sub>n+1</sub> = (aX<sub>n</sub> + c) mod m
•	m, a, c, X<sub>0</sub>가 정수라면, 이 기법은 0 ≤ X<sub>n</sub> < m 범위의 정수로 이루어진 수열을 생성함
•	좋은 난수 생성기를 만들기 위해 a, c, m 값의 선택이 매우 중요함
X<sub>1</sub>, X<sub>2</sub>, ... X<sub>n</sub>을 공격자가 알면 연립방정식을 풀어서 a,c,m을 알아낼 수 있으므로 안전하지 않은 방식이다.
## PRNG using Block Cipher Mode



