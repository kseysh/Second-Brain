## Random Numbers
암호화 기반의 여러 네트워크 보안 알고리즘과 프로토콜에서는 랜덤 이진수를 사용한다.
ex) AES용 session key, 대칭 stream encryption
## Randomness
• 숫자 시퀀스가 랜덤한지를 검증하기 위해 두 가지 기준이 사용된다:
	•	균등 분포
		▪ 1과 0의 발생 빈도가 대략 동일해야 한다
	•	독립성
		▪ 시퀀스 내의 어떤 부분 시퀀스도 다른 부분 시퀀스로부터 유추될 수 없어야 한다
## Unpredictability
• 시퀀스의 연속된 값들은 예측할 수 없어야 한다
	•	진정한 랜덤 숫자는 비효율성과 같은 한계가 있기 때문에, 일반적으로는 랜덤처럼 보이는 숫자 시퀀스를 생성하는 알고리즘이 더 자주 사용된다
	•	공격자가 시퀀스의 초기 값을 통해 이후 값을 예측하지 못하도록 주의해야 한다
## Pseudorandom Numbers
• 암호화 관련 응용에서는 일반적으로 알고리즘 기반의 랜덤 숫자 생성 기법을 사용한다
• 이러한 알고리즘은 결정론적이므로 통계적으로 진정한 랜덤은 아니다
• 알고리즘이 충분히 우수하다면 생성된 시퀀스는 여러 랜덤성 테스트를 통과할 수 있으며, 이를 의사 랜덤 숫자라고 한다
## Random and Pseudorandom Number Generators
![[Pasted image 20250417231539.png|400]]
TRNG = true random number generator (진짜 난수 생성기)
PRNG = pseudorandom number generator (의사 난수 생성기)
PRF = pseudorandom function (의사 난수 생성 함수)

## TRNG
• 사실상 랜덤한 소스를 입력으로 사용한다
• 이 소스는 엔트로피 소스라 하며, 컴퓨터의 물리적 환경에서 가져온다
	•	예: 키 입력 타이밍 패턴, 디스크의 전기적 활동, 마우스 움직임, 시스템 시계의 순간 값 등
	•	이러한 소스 또는 소스들의 조합은 랜덤한 이진 출력을 생성하는 알고리즘의 입력이 된다
• TRNG는 아날로그 소스를 단순히 이진으로 변환하거나
• 소스의 bias을 보정하기 위한 추가 처리를 포함할 수도 있다
## PRNG
• 고정된 값인 시드(seed) 를 입력으로 받아, 결정론적 알고리즘을 사용하여 비트 시퀀스를 생성한다
	•	시드는 종종 TRNG를 통해 생성된다
• 출력 비트 스트림은 오직 입력 값(시드 등)에 의해 결정되므로, 알고리즘과 시드를 알고 있는 공격자는 전체 비트 스트림을 재현할 수 있다
• 생성되는 비트 수 외에는 PRNG와 PRF 사이에 차이는 없다
•	의사 랜덤 숫자 생성기 (PRNG)
	•	무한한 비트 시퀀스를 생성하는 알고리즘
	•	대칭 스트림 암호에서 입력으로 사용되는 경우가 대표적인 예다
•	의사 랜덤 함수 (PRF)
	•	고정된 길이의 의사 랜덤 비트 문자열을 생성
	•	예: 대칭 키, nonce (일회성 값)
## Randomness Tests
이 수가 랜덤인지 아닌지를 판별할 수 있는 15개의 테스트 중 3가지
### Frequncy test
▪ 가장 기본적인 테스트이며, 모든 테스트 모음에 반드시 포함되어야 함
▪ 시퀀스 내의 1과 0의 개수가 진정한 랜덤 시퀀스에서 기대되는 수준과 유사한지를 판단하기 위한 것
0과 1의 분포가 특정 퍼센트 이상이면 탈락
### Runs test
▪ 이 테스트의 초점은 시퀀스 내의 전체 런(run) 수에 있음
▪ 런이란, 동일한 비트가 연속적으로 나타나는 구간으로, 앞뒤는 반대값의 비트로 경계 지어짐
▪ 다양한 길이의 1과 0 런의 개수가 랜덤 시퀀스에서 기대되는 수준과 일치하는지를 판단하는 것이 목적
100000000001에서 0의 개수가 일정 개수 이상이면 탈락
### Maurer’s universal statistical test
▪ 초점은 일치하는 패턴 사이의 비트 수에 있음
▪ 시퀀스가 정보 손실 없이 얼마나 압축 가능한지를 감지하는 것이 목적
▪ 유의미하게 압축 가능한 시퀀스는 비랜덤으로 간주됨
0001000100010001 => 0001 x 5 이렇게 압축이 잘 되면 탈락
## Generation of Seed Input to PRNG
![[Pasted image 20250417232906.png|100]]
## 알고리즘 설계
•	알고리즘은 두 가지 범주로 나뉨:
•	전용 알고리즘 (Purpose-built algorithms)
	▪ 의사 난수 비트 스트림 생성을 위해 특별히 설계된 알고리즘
•	기존 암호 알고리즘 기반 알고리즘
	▪ 입력 데이터를 무작위화하는 효과를 가짐
	▪ 일반적인 방법:
		– 대칭 블록 암호
		– 비대칭 암호
		– 해시 함수 및 메시지 인증 코드 (MAC)
## Linear Congruential Generator
•	Lehmer가 처음 제안한 알고리즘으로, 네 개의 수로 매개변수화됨:
	•	m : 모듈러스 (modulus), m > 0
	•	a : 곱셈 계수 (multiplier), 0 < a < m
	•	c : 증가값 (increment), 0 ≤ c < m
	•	X<sub>0</sub> : 시작 값 또는 시드 (seed), 0 ≤ X<sub>0</sub> < m
•	난수의 수열 \{X<sub>n</sub>\}은 다음과 같은 반복 방정식으로 생성됨:
	X<sub>n+1</sub> = (aX<sub>n</sub> + c) mod m
•	m, a, c, X<sub>0</sub>가 정수라면, 이 기법은 0 ≤ X<sub>n</sub> < m 범위의 정수로 이루어진 수열을 생성함
•	좋은 난수 생성기를 만들기 위해 a, c, m 값의 선택이 매우 중요함
X<sub>1</sub>, X<sub>2</sub>, ... X<sub>n</sub>을 공격자가 알면 연립방정식을 풀어서 a,c,m을 알아낼 수 있으므로 안전하지 않은 방식이다.
## PRNG using Block Cipher Mode
•	블록 암호를 사용하여 의사 난수 생성기(PRNG)를 구성하는 방식 중 두 가지가 널리 채택됨:
•	CTR (Counter) 모드
	•	NIST SP 800-90, ANSI 표준 X9.82, RFC 4086에서 권장
•	OFB (Output Feedback) 모드
	•	X9.82 및 RFC 4086에서 권장
### NIST CTR_DRBG
![[Pasted image 20250418000411.png|300]]
### TRNG + PRNG
•	NIST SP 800-90C (4번째 공개 초안)
•	무작위 비트 생성기(RBG) 구조에 대한 권장사항 포함
## 스트림 암호 설계 고려사항
•	암호화 시퀀스는 긴 주기(period)를 가져야 함
	→ PRNG는 결국 반복되는 결정적 비트 스트림을 생성하므로, 반복 주기가 길수록 암호 분석이 어려움
•	키 스트림은 진정한 난수 스트림의 특성에 가깝도록 만들어야 함
•	128비트 이상의 키 길이가 바람직함
•	잘 설계된 PRNG를 사용하면 스트림 암호도 동등한 키 길이의 블록 암호만큼 안전할 수 있음
## RC4
•	1987년 Ron Rivest가 RSA Security를 위해 설계함
•	*바이트 기반 연산*을 사용하는 *가변 키 크기 스트림 암호*
•	무작위 순열(random permutation) 기반
•	바이트 출력당 8~16개의 기계 연산 필요 → 소프트웨어에서 매우 빠르게 실행 가능
•	IEEE 802.11 무선 LAN 표준의 일부인 WPA 프로토콜에서 사용됨
지금 RFC에서 금지됨
## 기타 스트림 암호
•	예시:
•	ChaCha20 (RFC 8439): TLS 1.3 (RFC 8446)에서 사용
•	Salsa20
	•	2005년 설계
	•	EU의 ECRYPT 프로젝트인 eSTREAM에 제출되어 선정됨
	•	ARX 연산 사용: 32비트 덧셈, 비트 단위 XOR, 회전(rotation)
	•	128비트 또는 256비트 키 지원
	•	2008년 ChaCha라는 변형 버전 개발됨
## 엔트로피 소스 (Entropy Sources)
•	진정한 난수 생성기(TRNG)는 비결정적인(nondeterministic) 소스를 사용하여 난수를 생성함
•	RFC 4086은 컴퓨터에서 사용할 수 있는 진정한 난수 소스의 예로 다음을 제시함:
•	오디오/비디오 입력
	•	소스가 연결되지 않은 오디오 입력기, 렌즈 캡을 씌운 카메라 등은 본질적으로 열 잡음(thermal noise)을 생성
•	디스크 드라이브
	•	공기의 난류로 인해 회전 속도에 작은 무작위 변동이 있음
•	random.org와 같은 온라인 서비스는 인터넷을 통해 안전하게 난수를 제공
## PRNG vs. TRNG
![[Pasted image 20250418001509.png|400]]
## 조건화 (Conditioning)
•	TRNG의 출력은 편향(bias)될 수 있음 (예: 1이 0보다 더 많이 나오는 경우 등)
•	편향 정의:
	•	NIST SP 800-90B에서는 어떤 결과가 다른 결과보다 더 높은 확률로 발생하는 경우 해당 무작위 과정을 편향된(biased) 것으로 간주
•	엔트로피 비율(Entropy rate):
	•	디지털화된 잡음 소스가 엔트로피를 제공하는 비율
	•	비트 스트링의 무작위성 또는 예측 불가능성을 측정
	•	0 (무엔트로피) ~ 1 (완전한 엔트로피) 사이 값 (bias가 없으면 1 있으면 0에 가까워짐 0은 완전 규칙적인 것)
•	조건화 알고리즘(deskewing algorithms):
	•	비트 스트림을 더 무작위화하기 위한 방법
•	일반적으로 암호 알고리즘을 사용하여 무작위 비트를 스크램블함으로써 편향을 제거하고 엔트로피를 증가시킴
	•	가장 흔한 방식은 해시 함수 또는 대칭 블록 암호 사용
## 인텔 디지털 난수 생성기 (Intel DRNG)
•	기존의 TRNG는 일반적으로 키 생성이나 소량의 난수가 필요한 용도에만 사용됨
→ TRNG는 일반적으로 비트 생성 속도가 낮고 비효율적이었기 때문
•	Intel DRNG는 PRNG에 필적하는 비트 생성 속도를 가진 최초의 상용 TRNG로, 2012년 5월 이후 출시된 멀티코어 칩에 탑재
	•	하드웨어로 완전히 구현됨
	•	DRNG 전체가 프로세서와 동일한 멀티코어 칩 안에 포함되어 있음
## Intel DRNG Logical Structure
![[Pasted image 20250418001927.png|400]]
CBC MAC을 이용해 conditioning 진행, CTR을 이용해 PRNG 진행

Intel CPU instuctions RDSEED, RDRAND


