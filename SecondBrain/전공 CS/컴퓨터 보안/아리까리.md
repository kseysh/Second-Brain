###### MAC이란?
메시지와 비밀 키를 입력으로 받아 고정 길이의 값을 출력하는 함수이며, 이 값이 인증자의 역할을 한다
###### MAC을 이용해 인증, 기밀성 충족하는 방법
![[Pasted image 20250501203514.png|400]]
2번째 방법: 
K1으로 메시지 M에 대해 MAC을 생성 K2로 M과 MAC을 Encrypt -> 인증, 기밀성 충족
3번째 방법:
K2로 M Encrpt, K1으로 암호문 E(K2, M)에 대해 MAC 생성
###### HMAC 특징
대칭 블록 암호보다 소프트웨어에서 일반적으로 더 빠르게 실행됨
HMAC은 IP 보안을 위한 필수 구현 MAC으로 채택됨
NIST 표준(FIPS 198-1)으로도 제정됨
###### AE란? / AE 접근 방식
•	통신의 기밀성과 무결성을 동시에 보호하는 암호 시스템을 지칭하는 용어

•	인증 후 암호화: CCM
•	암호화 후 인증: GCM (Galois CTR 모드)
•	독립적으로 암호화 및 인증: 안전하지 않음
###### Counter + CBC-MAC
Encrypt는 counter mode로 하고, Authentication는 CBC-MAC을 사용하겠다는 의미
IEEE 802.11 WiFi의 보안 요구사항을 지원하는 표준
Authenticate then encrypt 방식 사용
###### RSA key generation 하는 법
소수 p, q 고르기
n = p x q
gcd(𝜙(n), e) = 1 인 e 고르기
d ≡ e<sup>-1</sup>(mod 𝜙(n))
###### Private key의 효율적 연산 방법
•	복호화는 d 제곱 연산 포함
	•	d가 작으면 무차별 대입 공격 등 다양한 공격에 취약 (그래서 d는 작게 하면 안됨)
•	계산 속도를 높이기 위해 중국인의 나머지 정리(CRT) 사용 가능
	•	d mod (p-1), d mod (q-1)을 미리 계산
	•	직접 계산보다 약 4배 빠르게 처리 가능
###### Factoring Problem 3가지
1. n을 소인수 분해하는 방법
	- n = p x q의 두 소수로 분해하면,
	- 오일러 함수 φ(n) = (p-1)(q-1)를 계산 할 수 있음
	- 이 값을 통해 비밀 키 d를 e<sup>-1</sup>mod φ(n)로 계산 가능
2. p, q 없이 φ(n) 직접 계산하는 방법
3.	φ(n) 없이 d를 직접 계산
###### CCA
Chosen Ciphertext Attack
암호문을 살짝 바꿔서 새로운 암호문을 만들어 복호화를 요청(query to decryption oracle)하고, 이를 수학적으로 계산하여 원래 메시지를 알아내는 방법
###### side-channel attacks의 대응책
•	키에 독립적인 연산 (예: 일정한 시간의 지수 계산)
•	무작위성 도입 (예: 무작위 지연)

###### CRT를 이용한 Fault Based Attack
- 공격자가 한쪽 모듈러 연산 (예: mod p)만 오류를 일으키면, 서명 값이 잘못되면서, 이 정보를 이용해 p 또는 q 중 하나를 추출할 수 있다.
###### ElGamal Cryptosystem의 전역 공개 요소
q : 큰 소수
a: q의 primitive root
###### ElGamal Cryptosystem의 Encryption 과정
세션 키 K 계산: K = (Y<sub>A</sub>)<sup>k</sup> mod q
C1 (세션 키 계산 용) 계산 : α<sup>k</sup> mod q (k는 random key)
C2 (메시지 계산 용) 계산: KM mod q
Y<sub>A</sub>, a를 k승한다고 생각
###### Elliptic Curve Arithmetic 장점
RSA/DH보다 훨씬 짧은 키 길이로 동일한 수준의 보안을 제공
###### ECC DH Key Exchange key generation
User A
PU: P<sub>A</sub> = n<sub>A</sub> x G
PR: n<sub>A</sub> = n보다 작은 임의의 정수

User B
PU: P<sub>B</sub> = n<sub>B</sub> x G
PR: n<sub>B</sub> = n보다 작은 임의의 정수
###### ECC DH Key Exchange 과정
K = n<sub>A</sub> x P<sub>B</sub>
K = n<sub>B</sub> x P<sub>A</sub>
###### DSA에서 subgroup을 사용하는 이유
DLP를 해결하는 두 가지 주요 알고리즘인 GNFS, Pollard rho 알고리즘에 의해 보안이 깨지지 않도록 큰 소수 p 위에 정의된 중간 크기의 cyclic subgroup(q)을 사용하면, 보안성을 유지하면서 지수 연산의 계산 효율성을 높일 수 있기 때문에 subgroup을 사용한다.
𝛼<sup>𝑥 mod 𝑞</sup> mod 𝑝
###### DLP를 해결하는 두 가지 주요 알고리즘
•	GNFS, General Number Field Sieve
	▪ *복잡도는 모듈러 p의 크기에 따라 달라짐*
	▪ 3072비트 p: 약 2<sup>128</sup> 연산 필요
•	Pollard rho 알고리즘
	▪ 생일 역설(birthday paradox)을 이용한 공격 (해시 충돌 탐색과 유사)
	▪ *복잡도는 x의 후보 수인 q에 따라 달라짐*
	▪ 2<sup>256</sup>개의 x 후보에 대해, 약 2<sup>128</sup> 연산 필요
	▪ 이를 위해 q ≈ 2<sup>256</sup>인 cyclic subgroup을 사용할 수 있음
###### Schnorr 인증이 무엇인지
• DLP를 이용한 challenge-response 기반 사용자 인증 방식
###### Schnorr signature
상호작용 기반 zero knowledge 증명 프로토콜
Fiat-Shamir 휴리스틱 사용
• 무작위 챌린지 𝑟을 H(M||𝛾)로 대체함
###### Flat-Shamir 휴리스틱이란?
상호작용 기반 지식 증명을 입력으로 받아 디지털 서명을 생성하는 방식
###### 전자 서명 알고리즘 세 개와 각각의 수학적 구조, 공통 요소
DSA, Schnorr Signature, ECDSA
DSA/Schnorr은 modulo p, ECDSA는 타원곡선
공통 요소(무작위 k, 해시함수 H(M), 유사한 검증 전략)
###### X.509 특징
•	공개키 암호와 디지털 서명 기반
•	특정 알고리즘 사용은 강제하지 않음
•	사용 예시: IPSec, TLS, 공동인증서 등
